{% extends 'dashboard/base.html' %}
{% block title %} REGISTER {% endblock %}

{% block content %}
{% load static %}

<section class="h-screen flex items-center px-4">
    <div class="flex flex-col md:flex-row max-w-8xl w-full min-h-[359px] p-5 overflow-hidden justify-center gap-10">
        <!-- Site Logo + Text -->
        <div class="flex flex-1 items-center justify-start p-8 max-w-[406px]">
            <div class="flex flex-col text-center max-w-md">
                <img src="{% static 'images/site-logo.svg' %}" alt="Logo" 
                     class="w-[200px] mx-auto mb-6">
                <p class="leading-relaxed text-xs">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                </p>
            </div>
        </div>

        <!-- Register Form -->
        <div class="flex flex-1 flex-col items-center max-w-[400px] justify-center px-7 py-8 space-y-8 bg-white shadow-[0_4px_10px_rgba(0,0,0,0.4)]">
            <!-- Heading -->
            <div class="text-center">
                <h1 class="text-2xl font-bold text-gray-900">Create Account</h1>
                <p class="text-gray-500 text-sm">Please enter your details to register</p>
            </div>
            
            {% if messages %}
            <div class="w-full max-w-md mx-auto">
                {% for message in messages %}
                    <div class="p-3 mb-2 text-sm rounded 
                        {% if message.tags == 'error' %}
                            bg-red-100 text-red-700 border border-red-400
                        {% elif message.tags == 'success' %}
                            bg-green-100 text-green-700 border border-green-400
                        {% else %}
                            bg-gray-100 text-gray-700 border border-gray-400
                        {% endif %}
                    ">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Form -->
            <div class="w-full max-w-sm space-y-5">
                <form method="post" class="space-y-5">
                    {% csrf_token %}
                    
                    <!-- Username -->
                    <div>
                        <label for="id_username" class="block text-sm font-medium text-gray-700">Username</label>
                        <input type="text" name="username" id="id_username" required
                            class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-600 focus:border-transparent focus:outline-none
                                {% if form.username.errors %} border-red-500 bg-red-50 {% endif %}"
                            value="{{ form.username.value|default:'' }}"
                            placeholder="Enter your username">
                        
                        <!-- Username Help Text (Always shown) -->
                        <div class="text-xs text-gray-500 mt-1">
                            Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.
                        </div>
                        
                        <!-- Username Errors -->
                        {% if form.username.errors %}
                            <div class="text-red-600 text-xs mt-1 space-y-1">
                                {% for error in form.username.errors %}
                                    <div class="flex items-center">
                                        <i class="bx bx-error-circle mr-1"></i>
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <!-- Password 1 -->
                    <div>
                        <label for="id_password1" class="block text-sm font-medium text-gray-700">Password</label>
                        <input type="password" name="password1" id="id_password1" required
                            class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-600 focus:border-transparent focus:outline-none
                                {% if form.password1.errors %} border-red-500 bg-red-50 {% endif %}"
                            placeholder="Enter your password">
                        
                        <!-- Password Help Text (Only shown when there are errors) -->
                        {% if form.password1.errors %}
                        <div class="text-xs text-gray-500 mt-1">
                            <ul class="list-disc list-inside space-y-1">
                                <li>Your password can't be too similar to your other personal information.</li>
                                <li>Your password must contain at least 8 characters.</li>
                                <li>Your password can't be a commonly used password.</li>
                                <li>Your password can't be entirely numeric.</li>
                            </ul>
                        </div>
                        {% endif %}
                        
                        <!-- Password Errors -->
                        {% if form.password1.errors %}
                            <div class="text-red-600 text-xs mt-1 space-y-1">
                                {% for error in form.password1.errors %}
                                    <div class="flex items-center">
                                        <i class="bx bx-error-circle mr-1"></i>
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <!-- Password 2 -->
                    <div>
                        <label for="id_password2" class="block text-sm font-medium text-gray-700">Confirm Password</label>
                        <input type="password" name="password2" id="id_password2" required
                            class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-600 focus:border-transparent focus:outline-none
                                {% if form.password2.errors %} border-red-500 bg-red-50 {% endif %}"
                            placeholder="Confirm your password">
                        
                        <!-- Confirm Password Help Text (Only shown when there are errors) -->
                        {% if form.password2.errors %}
                        <div class="text-xs text-gray-500 mt-1">
                            Enter the same password as before, for verification.
                        </div>
                        {% endif %}
                        
                        <!-- Confirm Password Errors -->
                        {% if form.password2.errors %}
                            <div class="text-red-600 text-xs mt-1 space-y-1">
                                {% for error in form.password2.errors %}
                                    <div class="flex items-center">
                                        <i class="bx bx-error-circle mr-1"></i>
                                        {{ error }}
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Display non-field errors -->
                    {% if form.non_field_errors %}
                    <div class="p-3 bg-red-100 border border-red-400 text-red-700 rounded text-sm">
                        <div class="font-medium mb-1">Please correct the following errors:</div>
                        <ul class="list-disc list-inside space-y-1">
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}

                    <!-- Actions -->
                    <div class="flex flex-col space-y-3 pt-3">
                        <button type="submit"
                            class="w-full bg-green-700 text-white py-2 rounded hover:bg-green-800 transition font-medium">
                            Create Account
                        </button>
                    </div>
                </form>
                
                <!-- Login Link -->
                <div class="text-center pt-4 border-t border-gray-200">
                    <p class="text-sm text-gray-600">
                        Already have an account? 
                        <a href="{% url 'login' %}" class="text-green-700 hover:underline font-medium">
                            Login here
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Add Boxicons for error icons -->
<script src="https://cdn.boxicons.com/2.0.7/boxicons.js"></script>

<style>
    /* Custom styles for better error visibility */
    .border-red-500 {
        border-color: #ef4444 !important;
    }
    
    .bg-red-50 {
        background-color: #fef2f2;
    }
    
    input:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(72, 187, 120, 0.2);
    }
    
    .border-red-500:focus {
        box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);
        border-color: #ef4444;
    }
</style>
{% endblock %}